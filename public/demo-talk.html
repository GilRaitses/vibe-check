<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Check NYC - AI Tinkerers Demo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400&family=Manrope:wght@200;300;400&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            font-weight: 200;
            background: linear-gradient(135deg, 
                #ffecd2 0%, 
                #fcb69f 25%, 
                #ff9a9e 50%, 
                #fecfef 75%, 
                #ffecd2 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            color: #2d1b69;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .vapor-trail {
            position: absolute;
            width: 200px;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.3) 50%, 
                transparent 100%);
            animation: vaporMove 20s linear infinite;
        }

        .vapor-trail:nth-child(1) { top: 20%; animation-delay: 0s; }
        .vapor-trail:nth-child(2) { top: 40%; animation-delay: -5s; }
        .vapor-trail:nth-child(3) { top: 60%; animation-delay: -10s; }
        .vapor-trail:nth-child(4) { top: 80%; animation-delay: -15s; }

        @keyframes vaporMove {
            0% { left: -200px; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { left: 100vw; opacity: 0; }
        }

        .container {
            position: relative;
            z-index: 10;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            font-family: 'Manrope', sans-serif;
            font-weight: 200;
            font-size: 3.5rem;
            text-align: center;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #2d1b69, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            font-weight: 200;
            font-size: 1.1rem;
            opacity: 0.8;
            margin-bottom: 40px;
        }

        .borough-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .borough-card {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .borough-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 20px 40px rgba(255, 107, 107, 0.2);
        }

        .borough-card.active {
            background: rgba(255, 255, 255, 0.4);
            border: 2px solid rgba(255, 107, 107, 0.5);
        }

        .borough-name {
            font-family: 'Manrope', sans-serif;
            font-weight: 300;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .borough-stats {
            font-size: 0.9rem;
            opacity: 0.7;
            font-weight: 200;
        }

        .map-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            min-height: 500px;
            position: relative;
        }

        .map-title {
            font-family: 'Manrope', sans-serif;
            font-weight: 300;
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .tessellated-map {
            width: 100%;
            height: 400px;
            position: relative;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
        }

        .zone-tile {
            position: absolute;
            background: rgba(255, 107, 107, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .zone-tile:hover {
            background: rgba(255, 107, 107, 0.6);
            z-index: 100;
            transform: scale(1.05);
        }

        .zone-popup {
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 15px;
            max-width: 300px;
            z-index: 200;
            font-size: 0.85rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .camera-feed {
            width: 100%;
            height: 120px;
            background: #f0f0f0;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: #666;
        }

        .live-data-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .data-card {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 25px;
        }

        .data-title {
            font-family: 'Manrope', sans-serif;
            font-weight: 300;
            font-size: 1.3rem;
            margin-bottom: 15px;
        }

        .api-test-btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border: none;
            border-radius: 25px;
            padding: 12px 25px;
            color: white;
            font-weight: 300;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .api-test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }

        .response-display {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 15px;
            padding: 15px;
            font-family: 'Inter', monospace;
            font-size: 0.8rem;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }

        .loading {
            opacity: 0.7;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        .nav-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .nav-btn {
            display: block;
            background: none;
            border: none;
            color: #2d1b69;
            padding: 8px 0;
            cursor: pointer;
            font-weight: 200;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            color: #ff6b6b;
            transform: translateX(5px);
        }
    </style>
</head>
<body>
    <!-- Vapor trails -->
    <div class="vapor-trail"></div>
    <div class="vapor-trail"></div>
    <div class="vapor-trail"></div>
    <div class="vapor-trail"></div>

    <!-- Navigation -->
    <div class="nav-menu">
        <button class="nav-btn" onclick="scrollToSection('overview')">Overview</button>
        <button class="nav-btn" onclick="scrollToSection('boroughs')">Boroughs</button>
        <button class="nav-btn" onclick="scrollToSection('live-data')">Live Data</button>
        <button class="nav-btn" onclick="scrollToSection('tech-stack')">Tech Stack</button>
    </div>

    <div class="container">
        <!-- Header -->
        <section id="overview">
            <h1>Vibe Check NYC</h1>
            <p class="subtitle">AI-Orchestrated Urban Navigation Intelligence</p>
        </section>

        <!-- Borough Selection & Map -->
        <section id="boroughs">
            <div class="borough-grid">
                <div class="borough-card" data-borough="MN" onclick="selectBorough('MN')">
                    <div class="borough-name">Manhattan</div>
                    <div class="borough-stats">329 zones ‚Ä¢ Midtown, SoHo, Upper East Side</div>
                </div>
                <div class="borough-card" data-borough="BK" onclick="selectBorough('BK')">
                    <div class="borough-name">Brooklyn</div>
                    <div class="borough-stats">202 zones ‚Ä¢ Williamsburg, DUMBO, Park Slope</div>
                </div>
                <div class="borough-card" data-borough="QN" onclick="selectBorough('QN')">
                    <div class="borough-name">Queens</div>
                    <div class="borough-stats">204 zones ‚Ä¢ Long Island City, Astoria</div>
                </div>
                <div class="borough-card" data-borough="SI" onclick="selectBorough('SI')">
                    <div class="borough-name">Staten Island</div>
                    <div class="borough-stats">95 zones ‚Ä¢ St. George, Tottenville</div>
                </div>
                <div class="borough-card" data-borough="BX" onclick="selectBorough('BX')">
                    <div class="borough-name">Bronx</div>
                    <div class="borough-stats">77 zones ‚Ä¢ South Bronx, Fordham</div>
                </div>
            </div>

            <!-- Tessellated Map -->
            <div class="map-container">
                <div class="map-title" id="map-title">Select a Borough to View Tessellated Zones</div>
                <div class="tessellated-map" id="tessellated-map">
                    <!-- Zone tiles will be populated here -->
                </div>
                <!-- Zone popup -->
                <div class="zone-popup" id="zone-popup">
                    <div class="camera-feed" id="camera-feed">Loading camera feed...</div>
                    <div id="zone-info"></div>
                </div>
            </div>
        </section>

        <!-- Live Data -->
        <section id="live-data">
            <div class="live-data-panel">
                <div class="data-card">
                    <div class="data-title">Live API Testing</div>
                    <button class="api-test-btn" onclick="testZone('MN_001')">Test Zone MN_001</button>
                    <button class="api-test-btn" onclick="testZone('BK_042')">Test Zone BK_042</button>
                    <button class="api-test-btn" onclick="testZone('QN_123')">Test Zone QN_123</button>
                    <button class="api-test-btn" onclick="loadCameraImage('MN_001')">Load Camera Image</button>
                    <div class="response-display" id="api-response">Click a button to test live API endpoints</div>
                </div>
                
                <div class="data-card">
                    <div class="data-title">System Status</div>
                    <div id="system-status">
                        <p>üü¢ Firebase Functions: Online</p>
                        <p>üü¢ Camera Network: 940 cameras active</p>
                        <p>üü¢ Zone Analytics: 907 zones mapped</p>
                        <p>üü¢ ML Pipeline: Processing</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tech Stack -->
        <section id="tech-stack">
            <div class="data-card">
                <div class="data-title">Technology Stack</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; font-size: 0.9rem;">
                    <div>
                        <strong>Backend:</strong><br>
                        ‚Ä¢ Firebase Functions<br>
                        ‚Ä¢ Google Cloud Vision AI<br>
                        ‚Ä¢ BigQuery ML<br>
                        ‚Ä¢ Firestore Database
                    </div>
                    <div>
                        <strong>Frontend:</strong><br>
                        ‚Ä¢ Angular 17<br>
                        ‚Ä¢ Voronoi Tessellation<br>
                        ‚Ä¢ Real-time Analytics<br>
                        ‚Ä¢ Progressive Web App
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        let currentBorough = null;
        const API_BASE = 'https://us-central1-vibe-check-463816.cloudfunctions.net/api';

        // Borough zone data
        const boroughZones = {
            'MN': { count: 329, zones: generateZones('MN', 329) },
            'BK': { count: 202, zones: generateZones('BK', 202) },
            'QN': { count: 204, zones: generateZones('QN', 204) },
            'SI': { count: 95, zones: generateZones('SI', 95) },
            'BX': { count: 77, zones: generateZones('BX', 77) }
        };

        function generateZones(borough, count) {
            const zones = [];
            for (let i = 1; i <= count; i++) {
                const id = `${borough}_${String(i).padStart(3, '0')}`;
                zones.push({
                    id: id,
                    x: Math.random() * 80 + 10, // 10-90% from left
                    y: Math.random() * 70 + 15, // 15-85% from top
                    width: Math.random() * 8 + 4, // 4-12% width
                    height: Math.random() * 8 + 4, // 4-12% height
                    heatLevel: Math.random() // 0-1 for heatmap intensity
                });
            }
            return zones;
        }

        function selectBorough(borough) {
            // Update active state
            document.querySelectorAll('.borough-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`[data-borough="${borough}"]`).classList.add('active');
            
            currentBorough = borough;
            
            // Update map title
            const boroughNames = {
                'MN': 'Manhattan',
                'BK': 'Brooklyn', 
                'QN': 'Queens',
                'SI': 'Staten Island',
                'BX': 'Bronx'
            };
            
            document.getElementById('map-title').textContent = 
                `${boroughNames[borough]} - ${boroughZones[borough].count} Zones`;
            
            // Populate tessellated map
            populateMap(borough);
        }

        function populateMap(borough) {
            const mapElement = document.getElementById('tessellated-map');
            mapElement.innerHTML = '';
            
            const zones = boroughZones[borough].zones;
            
            zones.forEach(zone => {
                const tile = document.createElement('div');
                tile.className = 'zone-tile';
                tile.style.left = zone.x + '%';
                tile.style.top = zone.y + '%';
                tile.style.width = zone.width + '%';
                tile.style.height = zone.height + '%';
                
                // Heat map coloring
                const intensity = zone.heatLevel;
                tile.style.background = `rgba(255, ${Math.floor(107 * (1-intensity))}, ${Math.floor(107 * (1-intensity))}, ${0.3 + intensity * 0.4})`;
                
                tile.addEventListener('mouseenter', (e) => showZonePopup(e, zone));
                tile.addEventListener('mouseleave', hideZonePopup);
                
                mapElement.appendChild(tile);
            });
        }

        function showZonePopup(event, zone) {
            const popup = document.getElementById('zone-popup');
            const rect = event.target.getBoundingClientRect();
            const mapRect = document.getElementById('tessellated-map').getBoundingClientRect();
            
            popup.style.left = (rect.left - mapRect.left + rect.width + 10) + 'px';
            popup.style.top = (rect.top - mapRect.top) + 'px';
            popup.style.display = 'block';
            
            document.getElementById('zone-info').innerHTML = `
                <strong>${zone.id}</strong><br>
                Heat Level: ${Math.round(zone.heatLevel * 100)}%<br>
                Status: ${zone.heatLevel > 0.7 ? 'High Activity' : zone.heatLevel > 0.4 ? 'Moderate' : 'Low Activity'}
            `;
            
            // Load camera image
            loadCameraForZone(zone.id);
        }

        function hideZonePopup() {
            document.getElementById('zone-popup').style.display = 'none';
        }

        function loadCameraForZone(zoneId) {
            const cameraFeed = document.getElementById('camera-feed');
            cameraFeed.innerHTML = 'Loading camera feed...';
            cameraFeed.classList.add('loading');
            
            // Try to get actual camera URL from API - NO FALLBACKS
            fetch(`${API_BASE}/get-camera-image/${zoneId}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.imageUrl) {
                        cameraFeed.innerHTML = `<img src="${data.imageUrl}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">`;
                    } else {
                        cameraFeed.innerHTML = `<div style="color: #cc0000; text-align: center;">‚ùå NO IMAGE URL<br>Zone: ${zoneId}<br>API returned: ${JSON.stringify(data)}</div>`;
                    }
                    cameraFeed.classList.remove('loading');
                })
                .catch(error => {
                    cameraFeed.innerHTML = `<div style="color: #cc0000; text-align: center;">‚ùå API ERROR<br>${error.message}<br>Zone: ${zoneId}<br>URL: ${API_BASE}/get-camera-image/${zoneId}</div>`;
                    cameraFeed.classList.remove('loading');
                });
        }

        async function testZone(zoneId) {
            const responseDiv = document.getElementById('api-response');
            responseDiv.innerHTML = 'Testing API endpoint...';
            responseDiv.classList.add('loading');
            
            try {
                const response = await fetch(`${API_BASE}/get-metrics/${zoneId}`);
                const data = await response.json();
                
                responseDiv.innerHTML = `
                    <strong>‚úÖ Response (${response.status})</strong><br>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
                responseDiv.classList.remove('loading');
            } catch (error) {
                responseDiv.innerHTML = `
                    <strong>‚ùå Error</strong><br>
                    ${error.message}
                `;
                responseDiv.classList.remove('loading');
            }
        }

        async function loadCameraImage(zoneId) {
            const responseDiv = document.getElementById('api-response');
            responseDiv.innerHTML = 'Loading camera image...';
            responseDiv.classList.add('loading');
            
            try {
                const response = await fetch(`${API_BASE}/get-camera-image/${zoneId}`);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                const data = await response.json();
                
                if (data.imageUrl) {
                    responseDiv.innerHTML = `
                        <strong>üì∏ Camera Image Loaded</strong><br>
                        <img src="${data.imageUrl}" style="max-width: 100%; border-radius: 8px; margin-top: 10px;">
                        <br><small>Zone: ${zoneId}</small>
                    `;
                } else {
                    responseDiv.innerHTML = `
                        <strong>‚ùå NO IMAGE URL</strong><br>
                        API Response: <pre>${JSON.stringify(data, null, 2)}</pre>
                        <br><small>Zone: ${zoneId}</small>
                    `;
                }
                responseDiv.classList.remove('loading');
            } catch (error) {
                responseDiv.innerHTML = `
                    <strong>‚ùå API ERROR</strong><br>
                    ${error.message}<br>
                    URL: ${API_BASE}/get-camera-image/${zoneId}<br>
                    <small>Zone: ${zoneId}</small>
                `;
                responseDiv.classList.remove('loading');
            }
        }

        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ 
                behavior: 'smooth' 
            });
        }

        // Auto-hide navigation menu
        let navTimeout;
        const navMenu = document.querySelector('.nav-menu');

        document.addEventListener('mousemove', () => {
            navMenu.style.opacity = '1';
            clearTimeout(navTimeout);
            navTimeout = setTimeout(() => {
                navMenu.style.opacity = '0.3';
            }, 3000);
        });

        // Initialize
        setTimeout(() => {
            selectBorough('MN'); // Start with Manhattan
        }, 1000);
    </script>
</body>
</html> 